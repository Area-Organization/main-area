---
title: Architecture & Data Schema
---

# Architecture & Data Schema

## Folder Structure

The backend follows a modular architecture:

```text
apps/backend/
├── prisma/
│   └── schema.prisma       # Data model definitions
├── src/
│   ├── database/           # Prisma client and Better Auth configuration
│   ├── hooks/              # Polling engine (manager.ts)
│   ├── interfaces/         # TypeScript service definitions (IAction, IReaction)
│   ├── middlewares/        # Authentication checks (session/token)
│   ├── plugins/            # Elysia plugins (Swagger, Better Auth handler)
│   ├── routes/             # API controllers (areas, connect, about)
│   ├── services/           # Third-party service implementations
│   │   ├── discord/
│   │   ├── drive/
│   │   ├── dropbox/
│   │   ├── github/
│   │   ├── gmail/
│   │   ├── notion/
│   │   ├── spotify/
│   │   ├── steam/
│   │   ├── trello/
│   │   ├── youtube/
│   │   └── registry.ts     # Singleton centralizing all services
│   ├── utils/              # Utilities (e.g., interpolator.ts)
│   ├── app.ts              # Elysia app configuration
│   └── index.ts            # Entry point
└── tests/                  # Unit and integration tests
```

## Key Libraries

Beyond the core technologies, the backend relies on specific libraries to ensure robustness and type safety:

- **@sinclair/typebox**: Used for runtime data validation and JSON schema generation. It ensures that incoming data (body, query params) conforms to the expected format.
- **@elysiajs/eden**: Generates a type-safe API client for the frontends (Web and Mobile). This guarantees full end-to-end type safety: if the backend changes a route, the frontend will fail to compile until it is updated.

## Database Schema (Prisma)

The main models defined in `schema.prisma` are:

- **User**: The central user entity.
- **Session / Account**: Managed by Better Auth for active sessions and OAuth connections.
- **UserConnection**: Stores credentials (`accessToken`, `refreshToken`, `metadata`) for a specific service (e.g., "spotify") linked to a user. This allows the backend to act on behalf of the user.
- **Area**: Represents an active automation. Contains the trigger count (`triggerCount`) and the date of the last execution (`lastTriggered`).
- **AreaAction**: Trigger configuration (stores specific parameters such as `repoName`).
- **AreaReaction**: Reaction configuration (stores parameters such as `playlistId`).

## Shared Types

The backend depends on the internal package `@area/types` (located in `packages/types`) to ensure that the DTOs (Data Transfer Objects) sent by the API exactly match what the clients expect.
