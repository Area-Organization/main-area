---
title: Architecture & Schéma de Données
---

# Architecture & Schéma de Données

## Structure des Dossiers

Le backend est organisé de manière modulaire pour séparer les préoccupations :

apps/backend/
├── prisma/
│ └── schema.prisma # Schéma de la base de données
├── src/
│ ├── database/ # Configuration de Prisma et de l'authentification
│ ├── hooks/ # Logique du déclencheur d'AREA (HookManager)
│ ├── interfaces/ # Interfaces TypeScript (IService, IAction, IReaction)
│ ├── middlewares/ # Middlewares Elysia (ex: vérification de session)
│ ├── plugins/ # Plugins Elysia (ex: configuration OpenAPI)
│ ├── routes/ # Définition des endpoints de l'API
│ ├── services/ # Logique des services externes (GitHub, Gmail, etc.)
│ │ ├── github/
│ │ ├── gmail/
│ │ └── registry.ts # Enregistrement de tous les services disponibles
│ ├── app.ts # Fichier principal d'initialisation de l'application Elysia
│ └── index.ts # Point d'entrée du serveur
└── package.json

## Schéma de la Base de Données (Prisma)

Le fichier `prisma/schema.prisma` définit la structure des données. Voici les modèles principaux :

-   `User`: Représente un utilisateur avec ses informations de base (email, nom).
-   `Session` & `Account`: Utilisés par **Better Auth** pour gérer les sessions actives et les comptes liés (OAuth).
-   `UserConnection`: Modèle central qui lie un `User` à un service externe (`serviceName`). Il stocke les jetons (`accessToken`, `refreshToken`) nécessaires pour interagir avec l'API du service.
-   `Area`: Représente une automatisation créée par un utilisateur. Elle contient un nom, une description et un statut (`enabled`). Elle est liée à une action et une réaction.
-   `AreaAction`: Définit le déclencheur d'une `Area`. Elle est liée à une `UserConnection` et contient les paramètres spécifiques à l'action (ex: le nom du dépôt GitHub à surveiller).
-   `AreaReaction`: Définit la conséquence d'une `Area`. Similaire à `AreaAction`, elle est liée à une `UserConnection` et stocke les paramètres de la réaction.